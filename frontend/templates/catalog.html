<html>
<head>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.2/axios.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/redux/3.7.2/redux.js"></script>
</head>
<body>
	<div id="root"></div>

<script type="text/babel">

var App = React.createClass({
  getDefaultProps: function() {
    return {
      ajaxApi: ["/api/category/?format=json",
                "/api/group/?format=json",
                "/api/item-type/?format=json",
                ]
      };
  },
  getInitialState: function() {
    return ({
      category: [],
      group: [],
      itemType: [],
      SelectedCategory: null
    });
  },

  fetchApiCallData: function(api) {
        return axios.get(api);
    },

  componentDidMount: function() {
    axios.all(this.props.ajaxApi.map(api => axios.get(api)))
    .then(axios.spread((req1, req2, req3) => {
      this.setState({
        category: req1.data,
        group: req2.data,
        itemType: req3.data
      })
    }))
  },

  onChangeCategory: function(e) {
  	this.setState({selectCategory:e.target.value});
  },  

  componentWillUnmount: function() {
    this.serverRequest.abort();
  },

  render: function() {
  	var message='You selected '+this.state.selectCategory;

    return (
      <div>
      
        <select onChange={this.onChangeCategory}>
          {this.state.category.map((catg,i) => 
            <option key={i}>{catg.description}</option>
          )}
        </select>

        <select onChange={this.onChangeCategory}>
          {this.state.group.map((group, i) =>
            <option key={i}>{group.description}</option>
          )}
        </select>

        <select onChange={this.onChangeCategory}>
          {this.state.itemType.map((item, i) =>
            <option key={i}>{item.name}</option>
          )}
        </select>

    		<p>{message}</p>

      </div>
    )
  }
});
ReactDOM.render(<App />, document.querySelector("#root"));

</script>


	<select id=catagory onChange='categoryOnChange()'>
	{% for each in category %}
	<option value={{each.id}}>{{each.description}}</option>
	{% endfor %}
	</select>

	<select>
	{% for each in group %}
	<option class="group catagory_{{each.id}}" value={{each.description}}>
	{{each.description}}
	</option>
	{% endfor %}
	</select>

	<select>
	{% for each in item_type %}
	<option class="item_type item_type_{{each.id}}" value={{each.name}}>{{each.name}}</option>
	{% endfor %}
	</select>

</body>
<script>
	$(function() {
		$('.group').hide()
		$('.item_type').hide()
		// debugger
	})

	function categoryOnChange(){

		var selected = $('#catagory').val()
		$('.catagory_' + selected).show()
	}
</script>
</html>